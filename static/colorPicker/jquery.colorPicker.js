jQuery.fn.colorPicker=function(e){var t=jQuery.extend({id:"jquery-color-picker",speed:500,colors:["FFFFFF","E26F50","EE8C0C","FDE163","91CE31","3497DB","82939E","B2C0D1",""],input:"",changeBG:!0},e),r=function(e){return.212671*e.substr(0,2)+.71516*e.substr(2,2)+.072169*e.substr(4,2)<.5?"ffffff":"000000"},n=jQuery("#"+t.id);return n.length||(n=jQuery('<div id="'+t.id+'"></div>').appendTo(document.body).hide(),jQuery(document.body).click(function(e){jQuery(e.target).is("#"+t.id)||jQuery(e.target).parents("#"+t.id).length||n.fadeOut(t.speed)})),this.each(function(){var e=jQuery(this),o=t.input.length?t.input:jQuery('<input type="hidden" name="'+e.attr("name")+'" value="'+e.attr("val")+'" size="6" />').insertAfter(e),c="";for(var u in t.colors)c+='<li><a href="#" title="#'+(""==t.colors[u]?"重置颜色":t.colors[u])+'" rel="'+t.colors[u]+'" style="background: #'+t.colors[u]+"; colour: "+r(t.colors[u])+';">'+(""==t.colors[u]?"重置颜色":"#"+t.colors[u])+"</a></li>";o.change(function(){t.changeBG&&e.css({background:o.val(),color:"#"+r(o.val())})}),o.change(),e.click(function(){var r=e.offset(),u=t.title?"<h2>"+t.title+"</h2>":"",i=document.documentElement.clientWidth,l=r.left;return r.left>i/2&&(l=r.left+e.outerWidth(!0)-n.outerWidth(!0)),n.html(u+"<ul>"+c+"</ul>").css({position:"absolute",left:l+"px",top:r.top+"px"}).fadeIn(t.speed),jQuery("a",n).click(function(){var r=jQuery(this).attr("rel");return""==r?(o.val(""),t.changBG&&e.css({background:""}),o.attr("title","")):(o.val("#"+r),o.attr("title","#"+r),t.changBG&&e.css({background:"#"+r})),o.change(),n.fadeOut(t.speed),!1}),!1})})};